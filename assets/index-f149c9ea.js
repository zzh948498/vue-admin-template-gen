import{v as ee,g as te,aq as he,ar as Ee,M as ke,b7 as ae,b8 as oe,a9 as le}from"./base-836f92ac.js";import{v as Te}from"./el-loading-56d3298e.js";/* empty css                       */import{b as Ce,e as Ve,c as xe}from"./el-row-3321aabf.js";import{_ as Re,b as Ue}from"./index-519ae781.js";/* empty css                        */import"./el-checkbox-a68956b8.js";import"./el-tag-53c25442.js";import"./el-tooltip-a900fd7e.js";import{a as Ae}from"./el-scrollbar-c79efbb2.js";import{s as R,E as ne}from"./request-8dcbea96.js";/* empty css                */import{c as A,E as Le}from"./el-button-c4b7bdc3.js";/* empty css                 */import"./el-form-item-4ed993c7.js";import{A as Se,C as re}from"./index-e4f9590d.js";import{j as M}from"./el-select-bbb2ffe6.js";import{E as Fe}from"./index-c68f2405.js";import{a as je,E as Be}from"./index-2bebcbf2.js";import{b as Me,E as De,f as qe}from"./el-checkbox-group-901df39c.js";import{a as Ge,E as Oe}from"./index-0363caf5.js";import{d as $e,r as d,O as ze,_ as Ie,b as D,e as ie,L as K,q as e,p as a,u as s,v as _,m as se,f as L,x as q,F as Ke,t as He}from"./runtime-core.esm-bundler-a0133d29.js";import"./typescript-defaf979.js";import"./icon-a83cb564.js";import"./index-ca0a5373.js";import"./event-e8463f65.js";import"./plugin-vueexport-helper-c27b6911.js";import"./validate-63e2cccc.js";import"./index-488f5cca.js";import"./initCloneObject-5bc7aa00.js";var H={},Ne={get exports(){return H},set exports(m){H=m}};(function(m,N){(function(h,E){E()})(A,function(){function h(l,n){return typeof n>"u"?n={autoBom:!1}:typeof n!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),n={autoBom:!n}),n.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(l.type)?new Blob(["\uFEFF",l],{type:l.type}):l}function E(l,n,f){var r=new XMLHttpRequest;r.open("GET",l),r.responseType="blob",r.onload=function(){T(r.response,n,f)},r.onerror=function(){console.error("could not download file")},r.send()}function V(l){var n=new XMLHttpRequest;n.open("HEAD",l,!1);try{n.send()}catch{}return 200<=n.status&&299>=n.status}function k(l){try{l.dispatchEvent(new MouseEvent("click"))}catch{var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),l.dispatchEvent(n)}}var c=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof A=="object"&&A.global===A?A:void 0,U=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),T=c.saveAs||(typeof window!="object"||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!U?function(l,n,f){var r=c.URL||c.webkitURL,u=document.createElement("a");n=n||l.name||"download",u.download=n,u.rel="noopener",typeof l=="string"?(u.href=l,u.origin===location.origin?k(u):V(u.href)?E(l,n,f):k(u,u.target="_blank")):(u.href=r.createObjectURL(l),setTimeout(function(){r.revokeObjectURL(u.href)},4e4),setTimeout(function(){k(u)},0))}:"msSaveOrOpenBlob"in navigator?function(l,n,f){if(n=n||l.name||"download",typeof l!="string")navigator.msSaveOrOpenBlob(h(l,f),n);else if(V(l))E(l,n,f);else{var r=document.createElement("a");r.href=l,r.target="_blank",setTimeout(function(){k(r)})}}:function(l,n,f,r){if(r=r||open("","_blank"),r&&(r.document.title=r.document.body.innerText="downloading..."),typeof l=="string")return E(l,n,f);var u=l.type==="application/octet-stream",G=/constructor/i.test(c.HTMLElement)||c.safari,S=/CriOS\/[\d]+/.test(navigator.userAgent);if((S||u&&G||U)&&typeof FileReader<"u"){var p=new FileReader;p.onloadend=function(){var b=p.result;b=S?b:b.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=b:location=b,r=null},p.readAsDataURL(l)}else{var O=c.URL||c.webkitURL,g=O.createObjectURL(l);r?r.location=g:location.href=g,r=null,setTimeout(function(){O.revokeObjectURL(g)},4e4)}});c.saveAs=T.saveAs=T,m.exports=T})})(Ne);function Pe(m){return R.post("/genTable/create",m)}function Ye(m){return R.post("/genTable/list",m)}function Qe(m){return R.delete(`/genTable/remove/${m.id}`)}function Xe(m){return R.post("/genTable/removes",m)}function We(m){return R.post("/genCode",m)}function Je(){return R.get("/genCode/templates")}const Ze={class:"app-container"},et={class:"dialog-footer"},tt={class:"dialog-footer"},Ft=$e({__name:"index",setup(m){const N=Se(),h=d(!1),E=d([]),V=d(!0),k=d(!0),c=d([]),U=d(!0),T=d(!0),l=d(0),n=d([]),f=d(),r=d(),u=d({name:"",desc:"",tplCategory:"crud"}),G=d({name:[{required:!0,message:"表名称不能为空",trigger:"blur"},{min:2,max:80,message:"表名称长度必须介于 2 和 80 之间",trigger:"blur"}],desc:[{required:!0,message:"表描述不能为空",trigger:"blur"}]}),S=ze({queryParams:{page:1,psize:10,name:void 0,desc:void 0},preview:{open:!1,title:"代码预览",data:{},activeName:"domain.java"}}),{queryParams:p,preview:O}=Ie(S);async function g(){V.value=!0;const{data:i}=await Ye({});E.value=i.data,l.value=i.total,V.value=!1}function b(){p.value.page=1,g()}const F=d(!1),x=d({formType:"dialog",template:"element-plus"}),j=d(0);async function P(){const i=j.value?[j.value]:n.value;if(i.length===0)return M.error("请选中一条数据");const{data:t}=await We({ids:i,...x.value}),w=new Int8Array(t.data),y=new Blob([w],{type:"application/zip"});H.saveAs(y,"ruoyi.zip")}const Y=d([]);(async()=>{const{data:i}=await Je();Y.value=i.data})();const Q=d();function ue(){var i;f.value=void 0,(i=Q.value)==null||i.resetFields(),b()}function de(){h.value=!0}async function pe(){var t,w;await((t=r.value)==null?void 0:t.validate())&&(await Pe(u.value),M.success("新增成功"),h.value=!1,g(),(w=r.value)==null||w.resetFields())}function ce(i){c.value=i.map(t=>t.id),n.value=i.map(t=>t.id),U.value=i.length!==1,T.value=!i.length}function X(i){const t=(i==null?void 0:i.id)||c.value[0];N.push({path:"/tool/gen/edit/index/"+t,query:{page:p.value.page}})}async function me(i){try{await ne('是否确认删除表编号为"'+i.id+'"的数据项？')}catch(t){return console.log(t)}await Qe({id:i.id}),g(),M.success("删除成功")}async function fe(){try{await ne('是否确认删除表编号为"'+c.value+'"的数据项？')}catch(i){return console.log(i)}await Xe({ids:c.value}),g(),M.success("删除成功")}return g(),(i,t)=>{const w=Fe,y=je,ve=Me,v=Le,$=Be,B=Ce,_e=Re,ge=Ve,C=Ge,z=Ae,be=Oe,ye=Ue,W=xe,I=De,J=qe,we=Te;return D(),ie("div",Ze,[K(e($,{ref_key:"queryRef",ref:Q,model:s(p),inline:!0,"label-width":"68px"},{default:a(()=>[e(y,{label:"表名称",prop:"name"},{default:a(()=>[e(w,{modelValue:s(p).name,"onUpdate:modelValue":t[0]||(t[0]=o=>s(p).name=o),placeholder:"请输入表名称",clearable:"",onKeyup:te(b,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(y,{label:"表描述",prop:"desc"},{default:a(()=>[e(w,{modelValue:s(p).desc,"onUpdate:modelValue":t[1]||(t[1]=o=>s(p).desc=o),placeholder:"请输入表描述",clearable:"",onKeyup:te(b,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(y,{label:"创建时间",style:{width:"308px"}},{default:a(()=>[e(ve,{modelValue:f.value,"onUpdate:modelValue":t[2]||(t[2]=o=>f.value=o),"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),e(y,null,{default:a(()=>[e(v,{type:"primary",icon:s(he),onClick:b},{default:a(()=>[_("搜索")]),_:1},8,["icon"]),e(v,{icon:s(Ee),onClick:ue},{default:a(()=>[_("重置")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"]),[[ee,k.value]]),e(ge,{gutter:10,class:"mb-2"},{default:a(()=>[e(B,{span:1.5},{default:a(()=>[e(v,{type:"primary",plain:"",icon:s(ke),onClick:de},{default:a(()=>[_("新建")]),_:1},8,["icon"])]),_:1},8,["span"]),e(B,{span:1.5},{default:a(()=>[e(v,{type:"primary",plain:"",icon:s(ae),onClick:t[3]||(t[3]=o=>P())},{default:a(()=>[_("生成")]),_:1},8,["icon"])]),_:1},8,["span"]),e(B,{span:1.5},{default:a(()=>[e(v,{type:"success",plain:"",icon:s(oe),disabled:U.value,onClick:t[4]||(t[4]=o=>{j.value=0,X()})},{default:a(()=>[_("修改")]),_:1},8,["icon","disabled"])]),_:1},8,["span"]),e(B,{span:1.5},{default:a(()=>[e(v,{type:"danger",plain:"",icon:s(le),disabled:T.value,onClick:fe},{default:a(()=>[_("删除")]),_:1},8,["icon","disabled"])]),_:1},8,["span"]),e(_e,{showSearch:k.value,"onUpdate:showSearch":t[5]||(t[5]=o=>k.value=o),onQueryTable:g},null,8,["showSearch"])]),_:1}),K((D(),se(be,{data:E.value,onSelectionChange:ce},{default:a(()=>[e(C,{type:"selection",align:"center",width:"55"}),e(C,{label:"序号",type:"index",width:"70",align:"center"},{default:a(o=>[L("span",null,q((s(p).page-1)*s(p).psize+o.$index+1),1)]),_:1}),e(C,{label:"表名称",align:"center",prop:"name","show-overflow-tooltip":!0}),e(C,{label:"表描述",align:"center",prop:"desc","show-overflow-tooltip":!0}),e(C,{label:"创建时间",align:"center",width:"160"},{default:a(o=>[L("span",null,q(s(re.dateFormat)(o.row.createdAt)),1)]),_:1}),e(C,{label:"更新时间",align:"center",width:"160"},{default:a(o=>[L("span",null,q(s(re.dateFormat)(o.row.updatedAt)),1)]),_:1}),e(C,{label:"操作",align:"center",width:"330","class-name":"small-padding fixed-width"},{default:a(o=>[e(z,{content:"编辑",placement:"top"},{default:a(()=>[e(v,{link:"",type:"primary",icon:s(oe),onClick:Z=>X(o.row)},null,8,["icon","onClick"])]),_:2},1024),e(z,{content:"删除",placement:"top"},{default:a(()=>[e(v,{link:"",type:"primary",icon:s(le),onClick:Z=>me(o.row)},null,8,["icon","onClick"])]),_:2},1024),e(z,{content:"生成代码",placement:"top"},{default:a(()=>[e(v,{link:"",type:"primary",icon:s(ae),onClick:Z=>{F.value=!0,j.value=o.row.id}},null,8,["icon","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[we,V.value]]),K(e(ye,{page:s(p).page,"onUpdate:page":t[6]||(t[6]=o=>s(p).page=o),limit:s(p).psize,"onUpdate:limit":t[7]||(t[7]=o=>s(p).psize=o),total:l.value,onPagination:g},null,8,["page","limit","total"]),[[ee,l.value>0]]),e(W,{modelValue:h.value,"onUpdate:modelValue":t[11]||(t[11]=o=>h.value=o),title:"添加表",width:"600px","append-to-body":""},{footer:a(()=>[L("div",et,[e(v,{type:"primary",onClick:pe},{default:a(()=>[_("确 定")]),_:1}),e(v,{onClick:t[10]||(t[10]=o=>h.value=!1)},{default:a(()=>[_("取 消")]),_:1})])]),default:a(()=>[e($,{ref_key:"tableAddRef",ref:r,model:u.value,rules:G.value,"label-width":"80px"},{default:a(()=>[e(y,{label:"表名称",prop:"name"},{default:a(()=>[e(w,{modelValue:u.value.name,"onUpdate:modelValue":t[8]||(t[8]=o=>u.value.name=o),placeholder:"请输入表名称",maxlength:"30"},null,8,["modelValue"])]),_:1}),e(y,{label:"表描述",prop:"desc"},{default:a(()=>[e(w,{modelValue:u.value.desc,"onUpdate:modelValue":t[9]||(t[9]=o=>u.value.desc=o),placeholder:"表描述",maxlength:"30"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),e(W,{modelValue:F.value,"onUpdate:modelValue":t[15]||(t[15]=o=>F.value=o),title:"生成代码",width:"600px","append-to-body":""},{footer:a(()=>[L("div",tt,[e(v,{type:"primary",onClick:P},{default:a(()=>[_("确 定")]),_:1}),e(v,{onClick:t[14]||(t[14]=o=>F.value=!1)},{default:a(()=>[_("取 消")]),_:1})])]),default:a(()=>[e($,{ref_key:"tableAddRef",ref:r,model:x.value,"label-width":"100px"},{default:a(()=>[e(y,{label:"表单类型",prop:"formType"},{default:a(()=>[e(J,{modelValue:x.value.formType,"onUpdate:modelValue":t[12]||(t[12]=o=>x.value.formType=o)},{default:a(()=>[e(I,{label:"dialog"},{default:a(()=>[_(" 弹窗")]),_:1}),e(I,{label:"page"},{default:a(()=>[_(" 新页面")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(y,{label:"模板",prop:"template"},{default:a(()=>[e(J,{modelValue:x.value.template,"onUpdate:modelValue":t[13]||(t[13]=o=>x.value.template=o)},{default:a(()=>[(D(!0),ie(Ke,null,He(Y.value,o=>(D(),se(I,{key:o,label:o},{default:a(()=>[_(q(o),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});export{Ft as default};
